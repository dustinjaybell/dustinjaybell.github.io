<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Happy MUELLER DAY</title>

      <link rel= "stylesheet" href="style.css"/>
  </head>

  <body>
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>My cool test page</title>

  <link rel="stylesheet" href="style.css" />
</head>

<body
{background-color: lightblue;}
>
<p> CLIMATE DATASETS IN NORTH AMERICA</p>
<p> BARCHARTS</p>


<script src="numbers.js"></script>
<svg width="2000px" height="900px">

</svg>
<p>MAP?</p>
<svg id="mysvg" width="2000px" height="2000px"></svg>


<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://unpkg.com/topojson@3"></script>
<script>


var regionLookup = {
  "AL":"SEA",
  "AK":"ALA",
  "AZ":"SPW",
  "AR":"SEA",
  "CA":"SPW",
  "CO":"SPL",
  "CT":"CEA",
  "DE":"CEA",
  "FL":"SEA",
  "GA":"SEA",
  "HI":"SPW",
  "ID":"CWP",
  "IL":"MID",
  "IN":"MID",
  "IA":"MID",
  "KS":"SPL",
  "KY":"MID",
  "LA":"SEA",
  "ME":"CEA",
  "MD":"CEA",
  "MA":"CEA",
  "MI":"MID",
  "MN":"MID",
  "MS":"SEA",
  "MO":"MID",
  "MT":"SPL",
  "NE":"SPL",
  "NV":"SPW",
  "NH":"CEA",
  "NJ":"CEA",
  "NM":"SPW",
  "NY":"CEA",
  "NC":"SEA",
  "ND":"SPL",
  "OH":"MID",
  "OK":"SPL",
  "OR":"CWP",
  "PA":"CEA",
  "RI":"CEA",
  "SC":"SEA",
  "SD":"SPL",
  "TN":"SEA",
  "TX":"SPL",
  "UT":"SPW",
  "VT":"CEA",
  "VA":"SEA",
  "WA":"CWP",
  "WV":"CEA",
  "WI":"MID",
  "WY":"SPL",
};

var sealevelLookup = {};

var color_scale=d3.scaleLinear()
  .domain([-5,0,5])
  .range(["green","yellow","red"]);

d3.queue()
  .defer(d3.json,"usa.json")
  .defer(d3.csv,"data1.csv")
  .defer(d3.csv,"sealevel1.csv")
  .defer(d3.csv,"hightemp.csv")
  .defer(d3.csv,"drydays.csv")
  .defer(d3.csv,"maxrainfall.csv")
  .defer(d3.csv,"Tempbelow.csv")
  .awaitAll(function(error,data){
      console.log(error,data);
      var sealevelData = data[2]
      sealevelData.forEach(function(d,i){
        for (var poop in d) {
          var num = +d[poop];

          if (isNaN(num) == false) {
            d[poop] = num;
          }


        }
        sealevelLookup[d.Location] = d;
      });
      console.log(sealevelLookup);

      var geoJSON = topojson.feature(data[0], data[0].objects.states);
      var proj = d3.geoAlbersUsa()
        .fitSize([2000,2000], geoJSON);

      var path = d3.geoPath()
        .projection(proj);

      var states = d3.select("#mysvg").selectAll("path")
        .data(geoJSON.features);

      states.enter().append("path")
        .attr("d", function(d) {
          return path(d);
        });

      colorMap("Jan-16");

  });

  function colorMap(column) {
    d3.select("#mysvg").selectAll("path")
      .attr("fill",function(d){
        var stateId = d.id;

        var region = regionLookup[stateId];
        var mydata = sealevelLookup[region];

        if (region=="MID")console.log(mydata[column])
        if (mydata){
          return color_scale(mydata[column]);
        }
        else{
          return "#ccc";
        }
      });

  }


  </script>


  <div id="slidecontainer">
  <input type="range" min="1966" max="2017" value="1966" class="slider" id="myRange">

</div>
<script>
var slider = document.getElementById("myRange");
var output = document.getElementById("demo");
output.innerHTML = slider.value; // Display the default slider value

// Update the current slider value (each time you drag the slider handle)
slider.oninput = function() {
    output.innerHTML = this.value;
}
</script>

<a href="http://actuariesclimateindex.org/explore/"> reference </a>
</body>

</body>
</html>
