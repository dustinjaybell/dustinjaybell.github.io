<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Happy MUELLER DAY</title>

      <link rel= "stylesheet" href="style.css"/>
  </head>

  <body>
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>My cool test page</title>

  <link rel="stylesheet" href="style.css" />
</head>

<body
{background-color: lightblue;}
>
<p> CLIMATE DATASETS IN NORTH AMERICA!</p>
<p>1 max rainfall, 2 sea level, 3 high temp, 4 dry days, 5 low temp</p>

<script src="numbers.js"></script>
<p>Climate Map</p>
<svg id="mysvg" width="500px" height="500px"></svg>

<div id="mysvgdiv"width="500px" height="500px"></div>



<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://unpkg.com/topojson@3"></script>
<script>


var regionLookup = {
  "AL":"SEA",
  "AK":"ALA",
  "AZ":"SPW",
  "AR":"SEA",
  "CA":"SPW",
  "CO":"SPL",
  "CT":"CEA",
  "DE":"CEA",
  "FL":"SEA",
  "GA":"SEA",
  "HI":"SPW",
  "ID":"CWP",
  "IL":"MID",
  "IN":"MID",
  "IA":"MID",
  "KS":"SPL",
  "KY":"MID",
  "LA":"SEA",
  "ME":"CEA",
  "MD":"CEA",
  "MA":"CEA",
  "MI":"MID",
  "MN":"MID",
  "MS":"SEA",
  "MO":"MID",
  "MT":"SPL",
  "NE":"SPL",
  "NV":"SPW",
  "NH":"CEA",
  "NJ":"CEA",
  "NM":"SPW",
  "NY":"CEA",
  "NC":"SEA",
  "ND":"SPL",
  "OH":"MID",
  "OK":"SPL",
  "OR":"CWP",
  "PA":"CEA",
  "RI":"CEA",
  "SC":"SEA",
  "SD":"SPL",
  "TN":"SEA",
  "TX":"SPL",
  "UT":"SPW",
  "VT":"CEA",
  "VA":"SEA",
  "WA":"CWP",
  "WV":"CEA",
  "WI":"MID",
  "WY":"SPL",
};

var dataLookup = {};
var datasets;
//var changename;
//var changenumber;
var color_scale=d3.scaleLinear()
  .domain([-5,0,5])
  .range(["green","yellow","red"]);

d3.queue()
  .defer(d3.json,"usa.json")
  .defer(d3.csv,"maxrainfall3.csv")
  .defer(d3.csv,"sealevel13.csv")
  .defer(d3.csv,"hightemp13.csv")
  .defer(d3.csv,"drydays3.csv")
  .defer(d3.csv,"Tempbelow3.csv")
  .awaitAll(function(error,data){
      console.log(error,data);
      datasets = data;

      var geoJSON = topojson.feature(data[0], data[0].objects.states);
      var proj = d3.geoAlbersUsa()
        .fitSize([500,500], geoJSON);

      var path = d3.geoPath()
        .projection(proj);

      var states = d3.select("#mysvg").selectAll("path")
        .data(geoJSON.features);

      states.enter().append("path")
        .attr("d", function(d) {
          return path(d);
        });


      changeDataset(2);
  });

  function changeDataset(datasetIndex) {
    console.log(datasets)
    var tempData = datasets[datasetIndex];
    tempData.forEach(function(d,i){
      for (var poop in d) {
        var num = +d[poop];

        if (isNaN(num) == false) {
          d[poop] = num;
        }


      }
      dataLookup[d.Location] = d;
    });
    console.log(dataLookup);

    colorStates("1");
  }

  function colorStates(column) {
    d3.select("#mysvg").selectAll("path")
      .attr("fill",function(d){
        var stateId = d.id;

        var region = regionLookup[stateId];
        var mydata = dataLookup[region];


        if (mydata){
          return color_scale(mydata[column]);
        }
        else{
          return "#ccc";
        }
      });

  }


  </script>

<p>Year</p>
  <div id="slidecontainer">
  <input type="range" min="1" max="225" value="1" class="slider" id="myRange">

</div>
<script>
var slider = document.getElementById("myRange");

//var output = document.getElementById("demo");
//output.innerHTML = slider.value; // Display the default slider value

// Update the current slider value (each time you drag the slider handle)
slider.oninput = function() {
  //  output.innerHTML = this.value;
  colorStates(this.value)
}
</script>

<div id="slidecontainer2">
<input type="range" min="1" max="5" value="1" class="slider" id="myRange1">

</div>

<p>Datasets</p>
<script>
var slider = document.getElementById("myRange1");

//var output = document.getElementById("demo");
//output.innerHTML = slider.value; // Display the default slider value

// Update the current slider value (each time you drag the slider handle)
slider.oninput = function(d) {
//  output.innerHTML = this.value;
changeDataset(this.value)
//numbers(this.value)
//if changenumber == 1
//   changename("red");
//   else if changenumber==2
//   changename("blue");
//   else if changenumber==3
//   changename("purple");
  // else if changenumber==4
//   changename("boobs");
//   else if changenumber==5
  // changename("muave");


}

</script>

<a href="http://actuariesclimateindex.org/explore/"> actuaries climax index </a>
</body>

</body>
</html>
